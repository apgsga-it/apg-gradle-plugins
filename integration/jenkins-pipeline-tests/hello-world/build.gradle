plugins {
    id 'com.palantir.docker-run' version '0.24.0'
    id 'java'
}

repositories {
    mavenCentral()
}

dockerRun {
    name "testsome"
    image 'jenkins4eval/jenkinsfile-runner'
    volumes 'Jenkinsfile': '/workspace/Jenkinsfile', 'jenkinsHome': '/jenkinsHome',  'jenkinsWorkspace': '/workspace'
    daemonize false
    clean true
    command '--runWorkspace', '/jenkinsWorkspace', '--runHome', '/jenkinsHome', '-a' ,'param1=Hellou' , '-a', 'param2=what ever you want'
}

task cleanJenkinsHome(type: Delete) {
    fileTree(dir: 'jenkinsHome').visit { FileVisitDetails details ->
        delete details.file
    }
    fileTree(dir: 'jenkinsWorkspace').visit { FileVisitDetails details ->
        delete details.file
    }
}




clean.dependsOn cleanJenkinsHome
